import{G as O,a as L,b as P,c as R,r as l,j as e,L as g,R as $,_ as d}from"./index-_pMZagxt.js";import{r as B,b as _,d as z}from"./firebase-enSJFrA3.js";function F(s){return O({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 12c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(s)}const M=()=>{const{user:s,status:j}=L(t=>t.user),b=P(),N=R(),[r,m]=l.useState(!1),[i,x]=l.useState(!1),y="https://firebasestorage.googleapis.com/v0/b/storyin-64d8b.appspot.com/o/assets%2FerrorImage.jpg?alt=media&token=8775dd92-495a-4722-9787-2e5a66485172",w="https://firebasestorage.googleapis.com/v0/b/storyin-64d8b.appspot.com/o/assets%2Fprofile.jpg?alt=media&token=668c8081-a5b3-469a-a8f6-3a8f7bb89fc7",[p,h]=l.useState(""),[c,v]=l.useState({date:"",duration:"",email:"",amount:"",expiry:"",orderId:"",paymentId:"",signature:"",userId:""}),[f,k]=l.useState([{_id:"",title:"",user:"",poster:""}]);l.useEffect(()=>{const t=new AbortController,a=async()=>{const o=await fetch("/api/order/get",{signal:t.signal}),{success:n,order:u}=await o.json();n===!0?v(u):N($())};return((s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="creator")&&(async()=>{const n=await fetch("/api/audio-book/userBooks",{signal:t.signal}),{success:u,data:C}=await n.json();u===!0&&(k(C),console.log(f))})(),a(),()=>t.abort()},[]);const D=t=>{m(!r),h(t)},I=async()=>{x(!0);const a=await(await fetch(`/api/audio-book/delete/${p}`,{method:"DELETE"})).json();if(a.success===!0){const o=B(_,a.url);z(o).then(()=>{d.success("deleted successfully")}).catch(n=>{d.error("Uh-oh, an error occurred!"),console.log(n)}),x(!1),h(""),window.location.reload()}else x(!1),h(""),d.error("Can't Delete!")},S=()=>{b(`/update/${p}`)},E=async()=>{const t=await fetch(`/api/fev/create/${p}`,{method:"POST"}),{message:a}=await t.json();m(!r),d.success(a)};return e.jsxs("div",{className:"flex gap-2 flex-col justify-center mt-3 mb-28 m-auto  items-center p-6 rounded-lg ",children:[e.jsxs("ul",{className:`mt-2 flex absolute z-10 bg-gray-900 text-white w-80 rounded-lg h-auto flex-col py-5 items-center ${r?"":"hidden"}`,children:[e.jsx("button",{disabled:i,onClick:()=>S(),className:"",children:"Edit"}),e.jsx("p",{className:"border-t-[0.5px] border-gray-300 my-2 w-[90%]"}),e.jsx("button",{disabled:i,onClick:()=>E(),className:"",children:"Favorite"}),e.jsx("p",{className:"border-t-[0.5px] border-gray-300 my-2 w-[90%]"}),e.jsx(g,{to:"/",className:"text-center",children:"Home"}),e.jsx("p",{className:"border-t-[0.5px] border-gray-300 my-2 w-[90%]"}),e.jsx("button",{disabled:i,onClick:()=>m(!1),className:" text-center",children:"Close"}),e.jsx("p",{className:"border-t-[0.5px] border-gray-300 my-2 w-[90%]"}),e.jsx("button",{disabled:i,onClick:()=>I(),className:"text-center text-red-500 font-bold",children:"Delete"})]}),e.jsxs("section",{className:`flex justify-center items-center flex-col ${r?"opacity-10":""}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{draggable:!1,src:s==null?void 0:s.photoURL,onError:t=>{t.currentTarget.src=w},alt:"Profile",className:"w-16 h-16 rounded-full mr-4 select-none"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold select-none",children:s==null?void 0:s.name}),e.jsx("p",{className:"text-gray-600",children:"Web Developer"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-10",children:[e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"",children:["Email:"," ",e.jsxs("span",{className:"text-black font-semibold",children:[" ",s==null?void 0:s.email," "]})," "]}),e.jsxs("p",{className:"",children:["Gender:"," ",e.jsxs("span",{className:"text-black font-semibold",children:[" ",s==null?void 0:s.gender," "]})," "]}),e.jsxs("p",{className:"",children:["Phone:"," ",e.jsx("span",{className:"text-black font-semibold",children:" (123) 456-7890 "})," "]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{children:["Subscription Status:"," ",j===!0?e.jsx("span",{className:"text-green-700 font-semibold",children:"Running "}):e.jsx("span",{className:"text-red-600 font-semibold",children:"None"})," "]}),j===!1?"":e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Due date:"," ",e.jsxs("span",{className:"text-green-700 font-semibold",children:[" ",c.date.slice(0,10)," "]})," "]}),e.jsxs("p",{children:["expiry:"," ",e.jsxs("span",{className:"text-green-700 font-semibold",children:[" ",c.expiry.slice(0,10)]})]}),e.jsxs("p",{children:["Duration:"," ",e.jsxs("span",{className:"text-green-700 font-semibold",children:[" ",c.duration]})]}),e.jsxs("p",{children:["Amount:"," ",e.jsxs("span",{className:"text-green-700 font-semibold",children:[" ","â‚¹",c.amount]})]}),e.jsxs("p",{children:["Order Id:"," ",e.jsxs("span",{className:"text-green-700 font-semibold",children:[" ",c.orderId]})]})]})]})]})]}),(s==null?void 0:s.role)==="creator"&&f.length>0?e.jsxs("section",{className:`m-auto flex flex-col justify-center w-full items-center gap-4 ${r?"opacity-10":""}`,children:[e.jsx("h1",{className:"font-semibold portrait:text-xl my-3",children:"My Books"}),e.jsx("div",{className:"flex justify-center gap-6 sm:gap-8 sm:max-w-[78%] max-w-[93%] flex-row flex-wrap",children:f.map((t,a)=>e.jsxs("div",{className:"flex justify-evenly mt-3 flex-col sm:w-[160px] w-[120px] h-[120px] sm:h-[181px]",children:[e.jsx("div",{className:"gap-1 rounded-md h-[160px] w-[153px] overflow-hidden",children:e.jsx(g,{to:`/book/${t._id}`,children:e.jsx("img",{draggable:!1,src:t.poster,onError:o=>{o.currentTarget.src=y},style:{userSelect:"none"},className:" rounded-md overflow-hidden duration-300 ease-in-out hover:scale-105",alt:"imgs"})},a)}),e.jsxs("div",{className:"flex justify-between items-center mt-2 max-w-[160px]",children:[e.jsx("h1",{className:"font-semibold text-sm max-w-[130px] truncate",children:t.title}),e.jsx("button",{onClick:()=>D(t._id),children:e.jsx(F,{className:"text-lg font-bold"})})]})]}))})]}):e.jsxs("section",{className:"m-auto flex flex-col justify-center items-center gap-4",children:[e.jsx("h1",{className:"font-semibold my-3",children:"My Books"}),e.jsx("h1",{className:"mt-3",children:"Create Your own audio book's by clicking to profile section . . ."})]})]})};export{M as default};
