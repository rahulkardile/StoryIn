import{r as l,u as k,a as v,j as e,F as S,L as _,N as F,_ as f}from"./index-o8-be8Tz.js";const L="https://firebasestorage.googleapis.com/v0/b/storyin-64d8b.appspot.com/o/assets%2FerrorImage.jpg?alt=media&token=8775dd92-495a-4722-9787-2e5a66485172",D=()=>{const[t,b]=l.useState({_id:"",title:"",description:"",user:{_id:"",name:""},poster:"",tags:"",episodes:[""],createdAt:"",updatedAt:""}),[c,u]=l.useState(""),[o,g]=l.useState([{poster:"",_id:"",title:"",user:{name:""}}]),[x,j]=l.useState(!1),[N,m]=l.useState(!1),{id:p}=k(),{user:a,status:h}=v(s=>s.user);l.useEffect(()=>{const s=new AbortController,r=async()=>{const n=await(await fetch(`/api/audio-book/get/${p}`,{signal:s.signal})).json();b(n)},i=async()=>{const n=await(await fetch("/api/audio-book/get",{signal:s.signal})).json();n.success===!0?g(n.data):f.error("problem")};return r(),i(),()=>s.abort()},[]);const w=async()=>{m(!0);const s=await fetch(`/api/fev/create/${p}`,{method:"POST"}),{message:r}=await s.json();f.success(r),j(!x),m(!1)},y=async()=>{if((h===!0||(a==null?void 0:a.role)==="admin"||t.user._id===(a==null?void 0:a._id))&&t.episodes.length>=0){const s={key:t.episodes[0]},r=await fetch("/api/audio-book/s3/getPoster",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),{success:i,url:d}=await r.json();i&&u(d)}};return t.episodes.length>=0&&(c.length>2||(y(),console.log(c))),e.jsx("section",{className:"text-gray-600 mt-14 mb-3 body-font",children:t!=null&&t.title?e.jsxs(e.Fragment,{children:[e.jsx("button",{disabled:N,onClick:()=>w(),className:`${x?"z-0 left-[83%] sm:left-[88%] text-2xl mr-5 bg-grey-100 rounded-lg top-24 text-red-500":""} absolute z-0 left-[83%] sm:left-[88%] text-2xl mr-5 bg-grey-100 rounded-lg top-24`,children:e.jsx(S,{})}),e.jsx("div",{className:"container flex flex-col sm:flex-row sm:mx-4 md:mx-8 gap-4 items-center justify-center",children:e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"mb-10 h-auto w-60 sm:w-64  xl:w-72 bg-red-200 object-contain object-center rounded",alt:"hero",src:`${t.poster}`,onError:s=>{s.currentTarget.src=L}}),e.jsxs("div",{className:"text-center lg:w-1/2 w-[90%] sm:w-full",children:[e.jsx("div",{className:"flex justify-evenly w-full",children:e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"title-font sm:text-4xl text-3xl mb-1 font-bold text-gray-900",children:t==null?void 0:t.title}),e.jsxs("p",{className:"font-semibold mb-4",children:["By"," ",e.jsx("span",{className:"text-orange-500 cursor-pointer font-bold",children:t==null?void 0:t.user.name})," ","With:"," ",e.jsx("span",{className:"text-orange-500 cursor-pointer font-bold",children:"Sanket Mhatre"})," ","Publisher"," ",e.jsx("span",{className:"text-orange-500 cursor-pointer font-bold",children:"Storyside IN"})]})]})}),e.jsxs("div",{className:"max-w-[550px] m-auto p-4 flex flex-row gap-8 justify-evenly border border-gray-500 border-t-[1px] border-b-[1px] border-x-0",children:[e.jsxs("span",{className:"font-semibold text-sm",children:["Ratings :"," ",e.jsx("span",{className:"font-bold  text-xs text-black",children:"19603"})]}),e.jsx("p",{className:"border-black border-r-2"}),e.jsxs("span",{className:"font-semibold text-sm",children:["Duration :"," ",e.jsx("span",{className:"font-bold text-xs  text-black",children:"4H 55min"})]}),e.jsx("p",{className:"border-black border-r-2"}),e.jsxs("span",{className:"font-semibold text-sm",children:["Language :"," ",e.jsx("span",{className:"font-bold text-xs  text-black",children:"Marathi"})]})]}),e.jsx("p",{className:"mb-8 max-w-[550px] line-clamp-6 m-auto mt-4",children:t==null?void 0:t.description})]})]})}),e.jsxs("div",{className:"flex flex-col items-center m-auto w-[90%] sm:max-w-[900px] justify-center",children:[e.jsx("h1",{children:"Episodes"}),e.jsx("p",{className:"border-t-[1px] my-3 border-slate-500 h-1 w-full"}),e.jsx("div",{className:"flex flex-row items-center mb-3 gap-2",children:h===!0||(a==null?void 0:a.role)==="admin"||t.user._id===(a==null?void 0:a._id)?e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"h-8 w-8 border-[1px] border-black text-black flex items-center text-sm justify-evenly rounded-full m-auto",children:e.jsx("span",{children:"1"})}),e.jsx("audio",{className:"sm:w-[500px] text-red-400",src:c,controls:!0})]}):e.jsxs("div",{className:"flex flex-col gap-2 items-center justify-center",children:[e.jsx("h1",{className:"text-black text-lg",children:"Buy Subscripion from here . . ."}),e.jsx(_,{to:"/subscription",className:"p-2 bg-orange-400 text-white mt-2 rounded-full px-9 text-sm lg:text-xl font-semibold sm:font-bold duration-300 hover:scale-105",children:"Subscribe Now"})]})}),e.jsx("p",{className:"border-t-[1px] my-3 border-slate-500 h-1 w-full"})]}),e.jsx("section",{className:"mt-6 flex flex-col gap-6",children:o.length>0?e.jsx(e.Fragment,{children:e.jsxs("section",{className:"w-screen sm:max-w-[1200px] flex flex-col gap-4 m-auto mb-9",children:[e.jsx("div",{className:"ml-6 mt-2",children:e.jsx("h1",{className:"font-semibold text-xl",children:"Recommended . . ."})}),e.jsx("div",{id:"scroll",className:"overflow-auto whitespace-nowrap mb-3",children:o==null?void 0:o.map((s,r)=>e.jsx(F,{img:`${s==null?void 0:s.poster}`,id:s==null?void 0:s._id,author:s==null?void 0:s.user.name,bookName:s==null?void 0:s.title},r))})]})}):e.jsx("h1",{children:"Loading . . ."})})]}):e.jsx("h1",{className:"flex justify-center items-center my-20",children:"Loading . . ."})})};export{D as default};
