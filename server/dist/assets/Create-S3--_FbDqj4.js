import{r as i,b as D,j as e,_ as a}from"./index-o8-be8Tz.js";import{r as k,b as q,u as A,c as F}from"./firebase-enSJFrA3.js";const R=()=>{const[f,c]=i.useState(""),[g,h]=i.useState(""),[b,p]=i.useState(""),[r,m]=i.useState(),[o,u]=i.useState(),[w,d]=i.useState(!1),j=D(),x=s=>{var l;const t=(l=s.target.files)==null?void 0:l[0];s.target.id==="img"&&(s.target.files!=null?m(t):a.error("Can't upload img")),s.target.id==="epi"&&(s.target.files!=null?u(t):a.error("Can't upload img"))},N=async s=>{s.preventDefault(),d(!0);try{let t="";if(r!==void 0&&(d(!0),r)){const n=k(q,`posters/${Date.now()+"_"+r.name}`);await A(n,r),t=await F(n)}console.log(t);const l={FileName:o!==void 0?o.name:"",FileType:o!==void 0?o.type:"",type:"epi"},y=await fetch("/api/audio-book/s3/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),{Key:v,success:E,url:S}=await y.json();if(E){if(!(await fetch(S,{method:"PUT",headers:{"Content-Type":l.FileType},body:o})).ok)return a.error("Episode Upload Error!!")}else a.error("Server Error For Uploading Episode!");const C=await fetch("/api/audio-book/new",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:f,description:g,tags:b,poster:t,episodes:v})}),{message:T,success:U}=await C.json();U?(a.success(T),j("/"),u(void 0),c(""),p(""),m(void 0)):a.error("Problem While Creating!!!")}catch(t){d(!1),console.log(t),a.error("Can't Upload!!!")}};return e.jsxs("section",{className:"flex justify-evenly flex-col gap-4 m-auto items-center mt-6 mb-24",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"List Your Audio Book"}),e.jsxs("form",{onSubmit:N,className:"flex sm:justify-between w-[90%] sm:[50%] sm:gap-8 flex-col sm:flex-row",children:[e.jsxs("div",{className:"w-full sm:w-[50%] ml-4",children:[e.jsxs("div",{className:"flex flex-col w-[95%] gap-1 mb-2",children:[e.jsx("span",{className:"text-xs font-medium",children:"Name"}),e.jsx("input",{type:"text",id:"title",onChange:s=>c(s.target.value),className:"p-2 w-[100%] border rounded",placeholder:"Name",required:!0})]}),e.jsxs("div",{className:"flex flex-col w-[95%] gap-1 mb-2",children:[e.jsx("span",{className:"text-xs font-medium",children:"Description"}),e.jsx("textarea",{id:"description",className:"p-5 w-[100%] border rounded",placeholder:"Description",onChange:s=>h(s.target.value),required:!0})]}),e.jsxs("div",{className:"flex flex-col w-[95%] gap-1 mb-2",children:[e.jsx("span",{className:"text-xs font-medium",children:"Tags"}),e.jsx("input",{type:"text",id:"tags",className:"p-2 w-[100%] border rounded",placeholder:"Add Tags",onChange:s=>p(s.target.value),required:!0})]}),e.jsxs("div",{className:"flex flex-col w-[95%] gap-1 mb-2",children:[e.jsx("span",{className:"text-xs font-medium",children:"Image"}),e.jsx("input",{type:"file",id:"img",accept:"image/*",className:"p-2 w-[100%] border rounded bg-white",onChange:x,required:!0})]})]}),e.jsxs("div",{className:"flex flex-col mt-5 w-full sm:w-[50%]",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2 mb-2",children:[e.jsx("h1",{className:"text-base font-semibold",children:"Audio Epicodes:"}),e.jsx("span",{className:"text-sm",children:"Add episode one after another "})]}),e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"file",id:"epi",accept:"audio/*",required:!0,multiple:!0,className:"p-2 w-[100%] border rounded bg-white",onChange:x})}),e.jsx("button",{type:"submit",disabled:w,className:"p-2 bg-black text-white font-semibold disabled:opacity-85 rounded ",children:"Upload"})]})]})]})};export{R as default};
